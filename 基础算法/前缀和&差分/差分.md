
# å·®åˆ†

å‚è€ƒï¼š[https://oi-wiki.org/basic/prefix-sum/](https://oi-wiki.org/basic/prefix-sum/)

å·®åˆ†æ˜¯ä¸€ç§å’Œå‰ç¼€å’Œç›¸å¯¹çš„ç­–ç•¥ï¼Œå¯ä»¥å½“åšæ˜¯æ±‚å’Œçš„é€†è¿ç®—ã€‚

å·®åˆ†æ•°ç»„å¯ç”±å‰ç¼€å’Œæ•°ç»„ç®—å‡ºï¼š
$$
diff[i] = 
\begin{cases}
preSum[i]-preSum[i-1] & i>1 \\
preSum[i] & i=0
\end{cases}
$$

åˆ™å·®åˆ†æ•°ç»„ä»0ç´¯åŠ åˆ°ç¬¬né¡¹ï¼Œä¹Ÿæ˜¯ç¬¬né¡¹å‰ç¼€å’Œä¸ºï¼š

$$
\begin{align}
\sum\limits_{i=0}^{n}diff[i] &= preSum[0] + preSum[1]-preSum[0] + ...+preSum[n] - preSum[n-1] \\
&= preSum[n]
\end{align}
$$

preSum ä¹Ÿå¯ç®—å‰ç¼€å’Œï¼š
$$
preSumSum[n] = \sum\limits_{i=1}^{n}preSum[i] = \sum\limits_{i=1}^{n}\sum\limits_{j=1}^{i}diff[j] = \sum\limits_{i=1}^{n}(n-i+1)diff[i]
$$

## å·®åˆ†æ•°ç»„çš„æ€§è´¨

å¯¹**å·®åˆ†æ•°ç»„å†…åŒºé—´ä¸¤ç«¯**è¿›è¡Œæ“ä½œä»¥ä»£æ›¿**å‰ç¼€å’Œæ•°ç»„å†…æ•´ä¸ªåŒºé—´**çš„æ“ä½œï¼Œ**æ—¶é—´å¤æ‚åº¦ä»O(k)é™è‡³O(1)ï¼‰**

ä¸€ä¸ªåŒºé—´`[i, i+k-1]`ï¼ŒåŒºé—´é•¿åº¦ä¸º`k`

åœ¨å·®åˆ†æ•°ç»„å†…åŒºé—´é¦–å…ƒç´ `diff[i]`åŠ ä¸Šå˜åŒ–é‡`â–³`ï¼ŒåŒºé—´å°¾å…ƒç´ çš„ä¸‹ä¸€ä½`diff[i+k]`å‡ä¸Šå˜åŒ–é‡`â–³`ï¼Œå°±å¯ä»¥ç®—å‡ºå·®åˆ†æ•°ç»„
$$
\begin{cases} diff[i]+\triangle \\ 
diff[i+k]-\triangle 
\end{cases}
$$

åº”ç”¨å‰ç¼€å’Œå…¬å¼ï¼Œå°±å¯ä»¥ç®—å‡ºå‰ç¼€å’Œæ•°ç»„
$$
pre\_sum[i] = pre\_sum[i-1]+diff[i]
$$

**è¯æ˜**

å‰ç¼€å’Œæ•°ç»„preSumåœ¨åŒºé—´é•¿åº¦ä¸º k çš„ [i, i+k-1] èŒƒå›´å†…çš„å…ƒç´ éƒ½åŠ ä¸€

å¯ä»¥çœ‹å‡ºå·®åˆ†æ•°ç»„åŒºé—´å†…çš„é¦–å…ƒç´ åŠ ä¸€ `diff[i]+1`ï¼Œæœ«å…ƒç´ çš„ä¸‹ä¸€ä½å‡ä¸€ `diff[i+k]-1`

| preSum(åŸæ¥)   | diff(åŸæ¥)                  | preSum(åŠ ä¸€å)      | diff(åŠ ä¸€å)                                |
| -------------- | --------------------------- | ------------------- | ------------------------------------------- |
| preSum[i-1]    | preSum[i-1]-preSum[i-2]     | preSum[i-1]         | preSum[i-1]-preSum[i-2]=diff[i-1]           |
| preSum[i]      | preSum[i]-preSum[i-1]       | **preSum[i]+1**     | **preSum[i]+1-preSum[i-1]=diff[i]+1**       |
| preSum[i+1]    | preSum[i+1]-preSum[i]       | **preSum[i+1]+1**   | preSum[i+1]+1-preSum[i]-1=diff[i+1]         |
| ...            | ...                         | ...                 | ...                                         |
| preSum[ i+k-2] | preSum[i+k-2]-preSum[i+k-3] | **preSum[i+k-2]+1** | preSum[i+k-2]+1-preSum[i+k-3]+1=diff[i+k-2] |
| preSum[ i+k-1] | preSum[i+k-1]-preSum[i+k-2] | **preSum[i+k-1]+1** | preSum[i+k-1]+1-preSum[i+k-2]+1=diff[i+k-1] |
| preSum[ i+k]   | preSum[i+k]-preSum[i+k-1]   | preSum[i+k**]**     | **preSum[i+k]-preSum[i+k-1]+1=diff[i+k]-1** |

å‰ç¼€å’Œæ•°ç»„å†…åŒºé—´å…ƒç´ æ•´ä½“åŠ ä¸€ï¼Œè€Œåœ¨å·®åˆ†æ•°ç»„å†…åŒºé—´åªæ˜¯ä¸¤ç«¯å˜åŒ–ï¼ˆé¦–å…ƒç´ åŠ ä¸€ï¼Œæœ«å…ƒç´ çš„ä¸‹ä¸€ä½å‡ä¸€ï¼‰

## ä¾‹é¢˜

[1109-[å·®åˆ†]-èˆªç­é¢„è®¢ç»Ÿè®¡](./ä¾‹é¢˜/1109-[å·®åˆ†]-èˆªç­é¢„è®¢ç»Ÿè®¡.md)

[995-[å·®åˆ†æ•°ç»„]-K è¿ç»­ä½çš„æœ€å°ç¿»è½¬æ¬¡æ•°](./ä¾‹é¢˜/995-[å·®åˆ†æ•°ç»„]-K è¿ç»­ä½çš„æœ€å°ç¿»è½¬æ¬¡æ•°.md)

---

`æ„Ÿè°¢`  ç‚¹èµ StarğŸŒŸ [https://github.com/DoWalle/algorithm](https://github.com/DoWalle/algorithm)

`å‘å¸ƒ`  Gitbook [https://dowalle.gitbook.io/algo/](https://dowalle.gitbook.io/algo/)
