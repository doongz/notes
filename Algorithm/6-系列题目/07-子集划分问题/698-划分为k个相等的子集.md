é¢˜ç›®ï¼š[698. åˆ’åˆ†ä¸ºkä¸ªç›¸ç­‰çš„å­é›†](https://leetcode.cn/problems/partition-to-k-equal-sum-subsets/)

é¢˜è§£ï¼š[ç»å…¸å›æº¯ç®—æ³•ï¼šé›†åˆåˆ’åˆ†é—®é¢˜ã€Œé‡è¦æ›´æ–° ğŸ”¥ğŸ”¥ğŸ”¥ã€ - åˆ’åˆ†ä¸ºkä¸ªç›¸ç­‰çš„å­é›† - åŠ›æ‰£ï¼ˆLeetCodeï¼‰](https://leetcode.cn/problems/partition-to-k-equal-sum-subsets/solution/by-lfool-d9o7/)

ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ `nums` å’Œä¸€ä¸ªæ­£æ•´æ•° `k`ï¼Œæ‰¾å‡ºæ˜¯å¦æœ‰å¯èƒ½æŠŠè¿™ä¸ªæ•°ç»„åˆ†æˆ `k` ä¸ªéç©ºå­é›†ï¼Œå…¶æ€»å’Œéƒ½ç›¸ç­‰ã€‚

```
ç¤ºä¾‹ 1ï¼š

è¾“å…¥ï¼š nums = [4, 3, 2, 3, 5, 2, 1], k = 4
è¾“å‡ºï¼š True
è¯´æ˜ï¼š æœ‰å¯èƒ½å°†å…¶åˆ†æˆ 4 ä¸ªå­é›†ï¼ˆ5ï¼‰ï¼Œï¼ˆ1,4ï¼‰ï¼Œï¼ˆ2,3ï¼‰ï¼Œï¼ˆ2,3ï¼‰ç­‰äºæ€»å’Œã€‚

ç¤ºä¾‹ 2:

è¾“å…¥: nums = [1,2,3,4], k = 3
è¾“å‡º: false
```

**æç¤ºï¼š**

- `1 <= k <= len(nums) <= 16`
- `0 < nums[i] < 10000`
- æ¯ä¸ªå…ƒç´ çš„é¢‘ç‡åœ¨ `[1,4]` èŒƒå›´å†…

## æ–¹æ³•ï¼šå›æº¯ + å‰ªæï¼ˆå­é›†åˆ’åˆ†é—®é¢˜ï¼‰

- æ’åºï¼šå…ˆä»å¤§åˆ°å°æ’åºï¼Œå…ˆè®©å€¼å¤§çš„å…ƒç´ é€‰æ‹©æ¡¶ï¼Œè¿™æ ·å¯ä»¥å¢åŠ å‰ªæçš„å‘½ä¸­ç‡ï¼Œä»è€Œé™ä½å›æº¯çš„æ¦‚ç‡
- å‰ªæ1ï¼šç¬¬ä¸€ä¸ªæ•°åªéœ€åˆ†é…è‡³ä¸€ä¸ª k ä½ç½®å³å¯ï¼Œå¯å‡å°‘ (k-1)/k ä¸ªé€’å½’æ ‘
- å‰ªæ2ï¼šå¦‚æœä¸€ä¸ªå­é›†çš„å’Œ å¤§äº åº”è¯¥çš„å¹³å‡å€¼ï¼Œæ˜¾ç„¶ä¸å¯èƒ½
- å‰ªæ3ï¼šå¦‚æœå½“å‰æ¡¶å’Œä¸Šä¸€ä¸ªæ¡¶å†…çš„å…ƒç´ å’Œç›¸ç­‰ï¼Œåˆ™è·³è¿‡

> åŸå› ï¼šå¦‚æœå…ƒç´ å’Œç›¸ç­‰ï¼Œé‚£ä¹ˆ nums[index] é€‰æ‹©ä¸Šä¸€ä¸ªæ¡¶å’Œé€‰æ‹©å½“å‰æ¡¶å¯ä»¥å¾—åˆ°çš„ç»“æœæ˜¯ä¸€è‡´çš„
>
> è¿™æ˜¯æœ€nbçš„å‰ªæ,1764 ms -> 0 ms

**æ’åºã€å‰ªæ2ã€å‰ªæ3 è¿™ä¸‰ä¸ªåœ°æ–¹å¿…é¡»éƒ½å­˜åœ¨ï¼Œéƒ½ä¸å¯æˆ–ç¼º**

æ—¶é—´å¤æ‚åº¦ï¼š`O(k^n)`

æ‰§è¡Œç”¨æ—¶ï¼š0 ms, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†100.00%çš„ç”¨æˆ·

å†…å­˜æ¶ˆè€—ï¼š9.2 MB, åœ¨æ‰€æœ‰ C++ æäº¤ä¸­å‡»è´¥äº†56.65%çš„ç”¨æˆ·

```cpp
class Solution {
public:
    int n;  // æ•°ç»„çš„é•¿åº¦
    int k;  // å­é›†çš„æ•°é‡
    vector<int> nums_sorted;
    vector<int> buckets;
    int average;

    // cur å½“å‰åº”è¯¥åˆ†é…çš„æ•°çš„ä¸‹æ ‡
    bool dfs(vector<int>& buckets, int cur) {
        if (cur == n) {
            // å‰ªæè¡¥å……ï¼šèµ°åˆ°è¿™é‡Œçš„æ¯ä¸ªæ¡¶ä¸€å®šæ˜¯å¹³å‡çš„ï¼Œæ‰€ä»¥å¯ä»¥ä¸ç”¨åˆ¤æ–­
            // ç›´æ¥è¿”å› trueï¼Œä½†æ˜¯è¿™é‡Œå‰ªææ”¶ç›Šå¾ˆå°å¾ˆå°
            for (int i = 0; i < k; i++) {
                if (buckets[i] != average) return false;
            }
            return true;
        }

        // å›æº¯
        int res = false;
        for (int i = 0; i < k; i++) {
            // å‰ªæ1ï¼šç¬¬ä¸€ä¸ªæ•°åªéœ€åˆ†é…è‡³ä¸€ä¸ª k ä½ç½®å³å¯ï¼Œå¯å‡å°‘ (k-1)/k ä¸ªé€’å½’æ ‘
            if (cur == 0 && i != 0) break;

            // å‰ªæ2ï¼šå¦‚æœä¸€ä¸ªå­é›†çš„å’Œ å¤§äº åº”è¯¥çš„å¹³å‡å€¼ï¼Œæ˜¾ç„¶ä¸å¯èƒ½
            if (buckets[i] + nums_sorted[cur] > average) continue;

            // å‰ªæ3ï¼šå¦‚æœå½“å‰æ¡¶å’Œä¸Šä¸€ä¸ªæ¡¶å†…çš„å…ƒç´ å’Œç›¸ç­‰ï¼Œåˆ™è·³è¿‡
            // åŸå› ï¼šå¦‚æœå…ƒç´ å’Œç›¸ç­‰ï¼Œé‚£ä¹ˆ nums[index] é€‰æ‹©ä¸Šä¸€ä¸ªæ¡¶å’Œé€‰æ‹©å½“å‰æ¡¶å¯ä»¥å¾—åˆ°çš„ç»“æœæ˜¯ä¸€è‡´çš„
            // è¿™æ˜¯æœ€nbçš„å‰ªæ,1764 ms -> 0 ms
            if (i > 0 && buckets[i] == buckets[i - 1]) continue;

            buckets[i] += nums_sorted[cur];
            res = dfs(buckets, cur + 1);
            buckets[i] -= nums_sorted[cur];
            if (res) break;
        }
        return res;
    }

    bool canPartitionKSubsets(vector<int>& nums, int k) {
        nums_sorted = nums;
        n = nums.size();
        this->k = k;
        buckets.resize(k, 0);

        // å…ˆæ’åºï¼Œå°½æ—©è§¦å‘ dfs ä¸­çš„å‰ªæï¼Œä¸ç¬¦åˆæ¡ä»¶çš„é€’å½’å°½å¿«ç»“æŸ
        sort(nums_sorted.begin(), nums_sorted.end(), greater<int>());

        int total = 0;
        for (int num : nums) total += num;
        if (total % k) return false;  // nums ä¸èƒ½å¹³åˆ†æˆ k ä»½ï¼Œç›´æ¥è¿”å›
        average = total / k;

        return dfs(buckets, 0);
    }
};
```