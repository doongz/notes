题目：[462. 最小操作次数使数组元素相等 II](https://leetcode.cn/problems/minimum-moves-to-equal-array-elements-ii/)

题解：https://leetcode.cn/problems/minimum-moves-to-equal-array-elements-ii/solution/by-fuxuemingzhu-13z3/

```python
class Solution:
    def minMoves2(self, nums: List[int]) -> int:
        nums.sort()
        mid = nums[len(nums) // 2]

        ans = 0
        for num in nums:
            ans += abs(num - mid)
        return ans
```

**题目大意**

每次移动，可以将数组中的某一个数字加 1 或者减 1。求最少移动多少次，能让数组中的数字都相等。

**解题方法**

假设经过移动以后，所有的数字最终都等于 target

那么这个 target 的取值有两种情况：在数组取值范围外、在数组取值范围内。

我们分情况讨论。

**情况一：target 在数组取值范围外**

target 在数组外的含义是 target > 数组最大值或者 target < 数组最小值。

假如 target 在数组取值范围之外，那么把所有数字移动到 target 一定比移动到边界的移动次数更多！

**情况二：target 在数组取值范围内**

当 target 在数组取值范围内，那么无论 target 选择何值，**对于数组的最小值和最大值而言，它们移动到 target 的次数之和一定是固定的！都等于 最大值 - 最小值**。

以 nums = [1, 2, 3, 4, 5, 6]，target = 4 为例，说明当 target 取值在 [1,6] 范围内，数字 1 与 数字 6 与 target 的距离之和是定值 5



然后，我们考虑**去除 nums 的最大值、最小值以后的「子数组」**，我们发现 target 也需要选择「子数组」范围之内的数字。

因为「情况一」中已经证明了，选择「子数组」取值范围外的数字不是最优。

综上， target 必须是不断选择 数组（以及子数组）最大值、最小值之间的数字，**最终就是「中位数」**。

**根据上面的分析，可以得出结论**：

- 当数组的长度是偶数时，target 可以选择 2 个中位数任何一个，总移动次数相等。
- 当数组的长度是奇数时，中位数只有 1 个，因此 target 选择此中位数。

对于数组 nums = [1, 2, 3, 4, 5, 6] 而言，targettarget 一定选择 3 或者 4。取两者任何一个，结果是相等的。

当数组长度为奇数时，target 一定选择中位数。

**如何求中位数**？

最简单的方法是将数组 nums 排序，然后取中间的位置的数字。时间复杂度是 O(n*log(n)

当然这也是个经典的 TopK 问题，可以参考 [215. 数组中的第K个最大元素](https://leetcode.cn/problems/kth-largest-element-in-an-array/) 这题的做法。比如「基于快速排序的选择方法」，可以把时间复杂度降到 O(N)。

