[373. æŸ¥æ‰¾å’Œæœ€å°çš„ K å¯¹æ•°å­—](https://leetcode-cn.com/problems/find-k-pairs-with-smallest-sums/)

ç»™å®šä¸¤ä¸ªä»¥ **å‡åºæ’åˆ—** çš„æ•´æ•°æ•°ç»„ `nums1` å’Œ `nums2` , ä»¥åŠä¸€ä¸ªæ•´æ•° `k` ã€‚

å®šä¹‰ä¸€å¯¹å€¼ `(u,v)`ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æ¥è‡ª `nums1`ï¼Œç¬¬äºŒä¸ªå…ƒç´ æ¥è‡ª `nums2` ã€‚

è¯·æ‰¾åˆ°å’Œæœ€å°çš„ `k` ä¸ªæ•°å¯¹ `(u1,v1)`, ` (u2,v2)` ...  `(uk,vk)` ã€‚

```
ç¤ºä¾‹ 1:

è¾“å…¥: nums1 = [1,7,11], nums2 = [2,4,6], k = 3
è¾“å‡º: [1,2],[1,4],[1,6]
è§£é‡Š: è¿”å›åºåˆ—ä¸­çš„å‰ 3 å¯¹æ•°ï¼š
     [1,2],[1,4],[1,6],[7,2],[7,4],[11,2],[7,6],[11,4],[11,6]
     
ç¤ºä¾‹ 2:

è¾“å…¥: nums1 = [1,1,2], nums2 = [1,2,3], k = 2
è¾“å‡º: [1,1],[1,1]
è§£é‡Š: è¿”å›åºåˆ—ä¸­çš„å‰ 2 å¯¹æ•°ï¼š
Â     [1,1],[1,1],[1,2],[2,1],[1,2],[2,2],[1,3],[1,3],[2,3]

ç¤ºä¾‹ 3:

è¾“å…¥: nums1 = [1,2], nums2 = [3], k = 3 
è¾“å‡º: [1,3],[2,3]
è§£é‡Š: ä¹Ÿå¯èƒ½åºåˆ—ä¸­æ‰€æœ‰çš„æ•°å¯¹éƒ½è¢«è¿”å›:[1,3],[2,3]
```

æç¤º:

1 <= nums1.length, nums2.length <= 105
-109 <= nums1[i], nums2[i] <= 109
nums1 å’Œ nums2 å‡ä¸ºå‡åºæ’åˆ—
1 <= k <= 1000

## æ–¹æ³•ä¸€ï¼šå¤šè·¯å½’å¹¶

[é¢˜è§£](https://leetcode-cn.com/problems/find-k-pairs-with-smallest-sums/solution/gong-shui-san-xie-duo-lu-gui-bing-yun-yo-pgw5/)

ä»¤ nums1 çš„é•¿åº¦ä¸º nï¼Œnums2 çš„é•¿åº¦ä¸º mï¼Œæ‰€æœ‰çš„ç‚¹å¯¹æ•°é‡ä¸º n * m

å…¶ä¸­æ¯ä¸ª nums1[i] å‚ä¸æ‰€ç»„æˆçš„ç‚¹åºåˆ—ä¸ºï¼š

[(nums1[0], nums2[0]), (nums1[0], nums2[1]), ... , (nums1[0],nums2[mâˆ’1])]
[(nums1[1], nums2[0]), (nums1[1], nums2[1]), ... , (nums1[1], nums2[mâˆ’1])]
...
[(nums1[nâˆ’1], nums2[0]), (nums1[nâˆ’1], nums2[1]), ... , (nums1[nâˆ’1], nums2[mâˆ’1])]

ç”±äº nums1 å’Œ nums2 å‡å·²æŒ‰å‡åºæ’åºï¼Œå› æ­¤æ¯ä¸ª nums1[i] å‚ä¸æ„æˆçš„ç‚¹åºåˆ—ä¹Ÿä¸ºå‡åºæ’åºï¼Œè¿™å¼•å¯¼æˆ‘ä»¬ä½¿ç”¨ã€Œå¤šè·¯å½’å¹¶ã€æ¥è¿›è¡Œæ±‚è§£ã€‚

å…·ä½“çš„ï¼Œèµ·å§‹æˆ‘ä»¬å°†è¿™ n ä¸ªåºåˆ—çš„é¦–ä½å…ƒç´ ï¼ˆç‚¹å¯¹ï¼‰ä»¥äºŒå…ƒç»„ (i,j) æ”¾å…¥ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå°æ ¹å †ï¼‰ï¼Œå…¶ä¸­ i ä¸ºè¯¥ç‚¹å¯¹ä¸­ nums1[i] çš„ä¸‹æ ‡ï¼Œj ä¸ºè¯¥ç‚¹å¯¹ä¸­ nums2[j] çš„ä¸‹æ ‡ï¼Œè¿™æ­¥æ“ä½œçš„å¤æ‚åº¦ä¸º O(nlogn)ã€‚è¿™é‡Œä¹Ÿå¯ä»¥å¾—å‡ºä¸€ä¸ªå°ä¼˜åŒ–æ˜¯ï¼šæˆ‘ä»¬å§‹ç»ˆç¡®ä¿ nums1 ä¸ºä¸¤æ•°ç»„ä¸­é•¿åº¦è¾ƒå°‘çš„é‚£ä¸ªï¼Œç„¶åé€šè¿‡æ ‡è¯†ä½æ¥è®°å½•æ˜¯å¦å‘ç”Ÿè¿‡äº¤æ¢ï¼Œç¡®ä¿ç­”æ¡ˆçš„ç‚¹é¡ºåºçš„æ­£ç¡®æ€§ã€‚

æ¯æ¬¡ä»ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †ï¼‰ä¸­å–å‡ºå †é¡¶å…ƒç´ ï¼ˆå«ä¹‰ä¸ºå½“å‰æœªè¢«åŠ å…¥åˆ°ç­”æ¡ˆçš„æ‰€æœ‰ç‚¹å¯¹ä¸­çš„æœ€å°å€¼ï¼‰ï¼ŒåŠ å…¥ç­”æ¡ˆï¼Œå¹¶å°†è¯¥ç‚¹å¯¹æ‰€åœ¨åºåˆ—çš„ä¸‹ä¸€ä½ï¼ˆå¦‚æœæœ‰ï¼‰åŠ å…¥ä¼˜å…ˆé˜Ÿåˆ—ä¸­ã€‚

ä¸¾ä¸ª ğŸŒ°ï¼Œé¦–æ¬¡å–å‡ºçš„äºŒå…ƒç»„ä¸º (0, 0)ï¼Œå³ç‚¹å¯¹ (nums1[0], nums2[0])ï¼Œå–å®Œåå°†åºåˆ—çš„ä¸‹ä¸€ä½ç‚¹å¯¹ (nums1[0], nums2[1]) ä»¥äºŒå…ƒç»„ (0, 1) å½¢å¼æ”¾å…¥ä¼˜å…ˆé˜Ÿåˆ—ã€‚

å¯é€šè¿‡ã€Œåè¯æ³•ã€è¯æ˜ï¼Œæ¯æ¬¡è¿™æ ·çš„ã€Œå–å½“å‰ï¼Œæ”¾å…¥ä¸‹ä¸€ä½ã€çš„æ“ä½œï¼Œå¯ä»¥ç¡®ä¿å½“å‰æœªè¢«åŠ å…¥ç­”æ¡ˆçš„æ‰€æœ‰ç‚¹å¯¹çš„æœ€å°å€¼å¿…ç„¶åœ¨ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †ï¼‰ä¸­ï¼Œå³å‰ k ä¸ªå‡ºå †çš„å…ƒç´ å¿…ç„¶æ˜¯æ‰€æœ‰ç‚¹å¯¹çš„å‰ k å°çš„å€¼ã€‚

![373](../../img/373.png)

### ç­–ç•¥

- å®šä¹‰å°æ ¹å †ï¼Œè‡ªå®šä¹‰æ’åºè§„åˆ™
- èµ·å§‹ï¼Œå°†è¿™ n ä¸ªåºåˆ—çš„é¦–ä½å…ƒç´ ä»¥äºŒå…ƒç»„ (i, j) æ”¾å…¥å°æ ¹å †ã€‚æ¢å¥è¯è¯´ï¼Œç°å°†å„æ¡è·¯çš„èµ·ç‚¹å…¥å †ï¼Œ(i, j)ä»£è¡¨äº†æ¯æ¡è·¯çš„ä¸‹æ ‡æŒ‡é’ˆ
- å¾ªç¯å– k ä¸ªå°æ ¹å †ã€Œå †é¡¶ã€ï¼Œç„¶åç§»é™¤ã€‚å¦‚æœå–çš„é‚£æ¡è·¯è¿˜æœ‰ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°†å…¶æ”¾å…¥å°æ ¹å †é‡Œ

æ—¶é—´å¤æ‚åº¦ï¼šä»¤ M ä¸º nã€m å’Œ k ä¸‰è€…ä¸­çš„æœ€å°å€¼ï¼Œå¤æ‚åº¦ä¸º `O(M+k)âˆ—logM)`

ç©ºé—´å¤æ‚åº¦ï¼š`O(M)`

**æœªä¼˜åŒ–ä»£ç **

```cpp
class Solution {
public:
    vector<vector<int>> kSmallestPairs(vector<int>& nums1, vector<int>& nums2, int k) {
        // å®šä¹‰å°æ ¹å †ï¼Œè‡ªå®šä¹‰æ’åºè§„åˆ™
        auto cmp = [&](const auto& a, const auto& b) {
            return nums1[a.first] + nums2[a.second] > nums1[b.first] + nums2[b.second];
        };
        priority_queue<pair<int, int>, vector<pair<int, int>>, decltype(cmp)> smallQ(cmp);
        
        int n = nums1.size();
        int m = nums2.size();
        // èµ·å§‹æˆ‘ä»¬å°†è¿™ n ä¸ªåºåˆ—çš„é¦–ä½å…ƒç´ ï¼ˆç‚¹å¯¹ï¼‰ä»¥äºŒå…ƒç»„ (i,j) æ”¾å…¥å°æ ¹å †
        // ç°å°†å„æ¡è·¯çš„èµ·ç‚¹å…¥å †ï¼Œ(i,j)ä»£è¡¨äº†æ¯æ¡è·¯çš„ä¸‹æ ‡æŒ‡é’ˆ
        for (int i = 0; i < min(n, k); i++) {
            smallQ.push({i, 0});
        }

        vector<vector<int>> ans;
        while (ans.size() < k and !smallQ.empty()) {
            int idx1 = smallQ.top().first;
            int idx2 = smallQ.top().second;
            smallQ.pop();
            ans.push_back({nums1[idx1], nums2[idx2]});
            if (idx2 + 1 < m) smallQ.push({idx1, idx2 + 1});
        }
        return ans;
    }
};
```

**ä¼˜åŒ–ä»£ç **

```cpp
class Solution {
public:
    vector<vector<int>> kSmallestPairs(vector<int>& nums1, vector<int>& nums2, int k) {
        //å§‹ç»ˆç¡®ä¿nums1ä¸ºä¸¤æ•°ç»„ä¸­é•¿åº¦è¾ƒå°‘çš„é‚£ä¸ª
        bool flag = true;
        int n = nums1.size(), m = nums2.size();
        if (nums1.size() > nums2.size()) {
            swap(nums1, nums2);
            swap(n, m);
            flag = false;
        }

        // å®šä¹‰å°æ ¹å †ï¼Œè‡ªå®šä¹‰æ’åºè§„åˆ™
        auto cmp = [&](const auto& a, const auto& b) {
            return nums1[a.first] + nums2[a.second] > nums1[b.first] + nums2[b.second];
        };
        priority_queue<pair<int, int>, vector<pair<int, int>>, decltype(cmp)> smallQ(cmp);

        // èµ·å§‹æˆ‘ä»¬å°†è¿™ n ä¸ªåºåˆ—çš„é¦–ä½å…ƒç´ ï¼ˆç‚¹å¯¹ï¼‰ä»¥äºŒå…ƒç»„ (i,j) æ”¾å…¥å°æ ¹å †
        for (int i = 0; i < min(n, k); i++) {
            smallQ.push({i, 0});
        }

        vector<vector<int>> ans;
        while (ans.size() < k and !smallQ.empty()) {
            int idx1 = smallQ.top().first;
            int idx2 = smallQ.top().second;

            smallQ.pop();
            if (flag) {
                ans.push_back({nums1[idx1], nums2[idx2]});
            } else {
                ans.push_back({nums2[idx2], nums1[idx1]});
            }

            if (idx2 + 1 < nums2.size()) smallQ.push({idx1, idx2 + 1});
        }
        return ans;
    }
};
```

## æ–¹æ³•äºŒï¼šæš´åŠ›-æœ‰åºé›†åˆï¼ˆè¶…æ—¶ï¼‰

- æ§åˆ¶æœ‰åºé›†åˆçš„å¤§å°ä¸º k ä¸ª
- æœ‰åºé›†åˆ ç”±å°åˆ°å¤§æ’åº
- æ¯”é›†åˆä¸­æœ€å¤§çš„è¦å°ï¼Œè¿›å…¥é›†åˆï¼Œç„¶åç§»é™¤æœ€å¤§çš„å…ƒç´ 

æ—¶é—´å¤æ‚åº¦ï¼š`O(nlogk)`

ç©ºé—´å¤æ‚åº¦ï¼š`O(k)`

**25 / 31** ä¸ªé€šè¿‡æµ‹è¯•ç”¨ä¾‹

```python
from sortedcontainers import SortedList
class Solution:
    def kSmallestPairs(self, nums1: List[int], nums2: List[int], k: int) -> List[List[int]]:
        sl = SortedList(key = lambda x : x[0]+x[1]) # ç”±å°åˆ°å¤§
        for n1 in nums1:
            for n2 in nums2:
                if len(sl) < k:
                    sl.add([n1, n2])
                else:
                    if n1 + n2 < sl[-1][0] + sl[-1][1]:
                        sl.add([n1, n2])
                        sl.pop()
        return sl[:]
```

## æ–¹æ³•ä¸‰ï¼šæš´åŠ›-å¤§æ ¹å †ï¼ˆè¶…æ—¶ï¼‰

- æ§åˆ¶å¤§æ ¹å †çš„å¤§å°ä¸º k ä¸ª
- å°äºå¤§æ ¹å †çš„å †é¡¶ï¼Œå…¥å †ï¼Œç„¶åç§»é™¤å †é¡¶
- æœ€åå–å‡ºå¤§æ ¹å †ä¸­çš„å…ƒç´ 

æ—¶é—´å¤æ‚åº¦ï¼š`O(nlogk)`

ç©ºé—´å¤æ‚åº¦ï¼š`O(k)`

**27 / 31** ä¸ªé€šè¿‡æµ‹è¯•ç”¨ä¾‹

```cpp
class Solution {
public:
    struct cmp {
        bool operator()(pair<int, int> p1, pair<int, int> p2) {
            return p1.first + p1.second < p2.first + p2.second;
        }
    };
    vector<vector<int>> kSmallestPairs(vector<int>& nums1, vector<int>& nums2, int k) {
        priority_queue<pair<int, int>, vector<pair<int, int>>, cmp> bigQ;
        for (int n1 : nums1) {
            for (int n2 : nums2) {
                if (bigQ.size() < k) {
                    bigQ.push({n1, n2});
                } else {
                    if (n1 + n2 < bigQ.top().first + bigQ.top().second) {
                        bigQ.push({n1, n2});
                        bigQ.pop();
                    }
                }
            }
        }

        vector<vector<int>> ans;
        while (!bigQ.empty()) {
            // cout << bigQ.top().first << ", " << bigQ.top().second << endl;
            ans.push_back({bigQ.top().first, bigQ.top().second});
            bigQ.pop();
        }

        return ans;
    }
};
```

