é¢˜ç›®ï¼š[187. é‡å¤çš„DNAåºåˆ—](https://leetcode-cn.com/problems/repeated-dna-sequences/)

é¢˜è§£ï¼šhttps://mp.weixin.qq.com/s?__biz=MzU4NDE3MTEyMA==&mid=2247489813&idx=1&sn=7f3bc18ca390d85b17655f7164d8e660

**DNAåºåˆ—** ç”±ä¸€ç³»åˆ—æ ¸è‹·é…¸ç»„æˆï¼Œç¼©å†™ä¸º `'A'`, `'C'`, `'G'` å’Œ `'T'`.ã€‚

- ä¾‹å¦‚ï¼Œ`"ACGAATTCCG"` æ˜¯ä¸€ä¸ª **DNAåºåˆ—** ã€‚

åœ¨ç ”ç©¶ DNA æ—¶ï¼Œè¯†åˆ« DNA ä¸­çš„é‡å¤åºåˆ—éå¸¸æœ‰ç”¨ã€‚

ç»™å®šä¸€ä¸ªè¡¨ç¤º DNAåºåˆ— çš„å­—ç¬¦ä¸² s ï¼Œè¿”å›æ‰€æœ‰åœ¨ DNA åˆ†å­ä¸­å‡ºç°ä¸æ­¢ä¸€æ¬¡çš„ é•¿åº¦ä¸º 10 çš„åºåˆ—(å­å­—ç¬¦ä¸²)ã€‚ä½ å¯ä»¥æŒ‰ ä»»æ„é¡ºåº è¿”å›ç­”æ¡ˆã€‚

```
ç¤ºä¾‹ 1ï¼š

è¾“å…¥ï¼šs = "AAAAACCCCCAAAAACCCCCCAAAAAGGGTTT"
è¾“å‡ºï¼š["AAAAACCCCC","CCCCCAAAAA"]

ç¤ºä¾‹ 2ï¼š

è¾“å…¥ï¼šs = "AAAAAAAAAAAAA"
è¾“å‡ºï¼š["AAAAAAAAAA"]
```

**æç¤ºï¼š**

- `0 <= s.length <= 105`
- `s[i]``==``'A'`ã€`'C'`ã€`'G'` or `'T'`



## æ–¹æ³•ä¸€ï¼šå“ˆå¸Œè¡¨+æ»‘åŠ¨çª—å£

ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨ç»Ÿè®¡ s æ‰€æœ‰é•¿åº¦ä¸º 10 çš„å­ä¸²çš„å‡ºç°æ¬¡æ•°ï¼Œè¿”å›æ‰€æœ‰å‡ºç°æ¬¡æ•°è¶…è¿‡ 1 çš„å­ä¸²ã€‚

ä»£ç å®ç°æ—¶ï¼Œå¯ä»¥ä¸€è¾¹éå†å­ä¸²ä¸€è¾¹è®°å½•ç­”æ¡ˆï¼Œä¸ºäº†ä¸é‡å¤è®°å½•ç­”æ¡ˆï¼Œæˆ‘ä»¬åªç»Ÿè®¡å½“å‰å‡ºç°æ¬¡æ•°ä¸º 2 çš„å­ä¸²ã€‚

æ—¶é—´å¤æ‚åº¦ï¼š`O(C*n) `

ç©ºé—´å¤æ‚åº¦ï¼š`O(n)`

```cpp
class Solution {
public:
    const int L = 10;
    vector<string> findRepeatedDnaSequences(string s) {
        vector<string> ans;
        unordered_map<string, int> cnt;
        int n = s.length();
        for (int i = 0; i <= n - L; i++) {
            string sub = s.substr(i, L);
            cnt[sub]++;
            if (cnt[sub] == 2) {
                ans.push_back(sub);
            }
        }
        return ans;
    }
};

```

## æ–¹æ³•äºŒï¼šå­—ç¬¦ä¸²å“ˆå¸Œ + å‰ç¼€å’Œ

å­ä¸²é•¿åº¦ä¸º 10ï¼Œå› æ­¤ä¸Šè¿°è§£æ³•çš„è®¡ç®—é‡ä¸º 10^6

è‹¥é¢˜ç›®ç»™å®šçš„å­ä¸²é•¿åº¦å¤§äº 100 æ—¶ï¼ŒåŠ ä¸Šç”Ÿæˆå­ä¸²å’Œå“ˆå¸Œè¡¨æœ¬èº«å¸¸æ•°æ“ä½œï¼Œé‚£ä¹ˆè®¡ç®—é‡å°†è¶…è¿‡ 10^7ï¼Œä¼š TLEã€‚

å› æ­¤ä¸€ä¸ªèƒ½å¤Ÿåšåˆ°ä¸¥æ ¼ `O(n)` çš„åšæ³•æ˜¯ä½¿ç”¨ã€Œå­—ç¬¦ä¸²å“ˆå¸Œ + å‰ç¼€å’Œã€ã€‚

å…·ä½“åšæ³•ä¸ºï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªä¸å­—ç¬¦ä¸² `s` ç­‰é•¿çš„å“ˆå¸Œæ•°ç»„ `h[]`ï¼Œä»¥åŠæ¬¡æ–¹æ•°ç»„ `p[]`ã€‚

ç”±å­—ç¬¦ä¸²é¢„å¤„ç†å¾—åˆ°è¿™æ ·çš„å“ˆå¸Œæ•°ç»„å’Œæ¬¡æ–¹æ•°ç»„å¤æ‚åº¦ä¸º `O(n)`ã€‚

å½“æˆ‘ä»¬éœ€è¦è®¡ç®—å­ä¸² `s[i....j]` çš„å“ˆå¸Œå€¼ï¼Œåªéœ€è¦åˆ©ç”¨å‰ç¼€å’Œæ€æƒ³ `h[j] - h[i-1] * p[j-i+1]` å³å¯åœ¨ `O(1)` æ—¶é—´å†…å¾—å‡ºå“ˆå¸Œå€¼ï¼ˆä¸å­ä¸²é•¿åº¦æ— å…³ï¼‰ã€‚

**åˆ°è¿™é‡Œï¼Œè¿˜æœ‰ä¸€ä¸ªå°å°çš„ç»†èŠ‚éœ€è¦æ³¨æ„ï¼šå¦‚æœæˆ‘ä»¬æœŸæœ›åšåˆ°ä¸¥æ ¼ ï¼Œè¿›è¡Œè®¡æ•°çš„ã€Œå“ˆå¸Œè¡¨ã€å°±ä¸èƒ½æ˜¯ä»¥ `String` ä½œä¸º `key`ï¼Œåªèƒ½ä½¿ç”¨ `Integer`ï¼ˆä¹Ÿå°±æ˜¯ hash ç»“æœæœ¬èº«ï¼‰ä½œä¸º `key`ã€‚å› ä¸º Java ä¸­çš„ `String` çš„ `hashCode` å®ç°æ˜¯ä¼šå¯¹å­—ç¬¦ä¸²è¿›è¡Œéå†çš„ï¼Œè¿™æ ·å“ˆå¸Œè®¡æ•°è¿‡ç¨‹ä»ä¸é•¿åº¦æœ‰å…³ï¼Œè€Œ `Integer` çš„ `hashCode` å°±æ˜¯è¯¥å€¼æœ¬èº«ï¼Œè¿™æ˜¯ä¸é•¿åº¦æ— å…³çš„**ã€‚

```cpp
class Solution {
    int N = (int)1e5+10, P = 131313;
    int[] h = new int[N], p = new int[N];
    public List<String> findRepeatedDnaSequences(String s) {
        int n = s.length();
        List<String> ans = new ArrayList<>();
        p[0] = 1;
        for (int i = 1; i <= n; i++) {
            h[i] = h[i - 1] * P + s.charAt(i - 1);
            p[i] = p[i - 1] * P;
        }
        Map<Integer, Integer> map = new HashMap<>();
        for (int i = 1; i + 10 - 1 <= n; i++) {
            int j = i + 10 - 1;
            int hash = h[j] - h[i - 1] * p[j - i + 1];
            int cnt = map.getOrDefault(hash, 0);
            if (cnt == 1) ans.add(s.substring(i - 1, i + 10 - 1));
            map.put(hash, cnt + 1);
        }
        return ans;
    }
}
```

- æ—¶é—´å¤æ‚åº¦ï¼šO(n)
- ç©ºé—´å¤æ‚åº¦ï¼šO(n)

---

1. å­—ç¬¦ä¸²å“ˆå¸Œçš„ã€Œæ„é€  `p` æ•°ç»„ã€å’Œã€Œè®¡ç®—å“ˆå¸Œã€çš„è¿‡ç¨‹ï¼Œä¸ä¼šæº¢å‡ºå—ï¼Ÿ

ä¼šæº¢å‡ºï¼Œæº¢å‡ºå°±ä¼šå˜ä¸ºè´Ÿæ•°ï¼Œå½“ä¸”ä»…å½“ä¸¤ä¸ªå“ˆå¸Œå€¼æº¢å‡ºç¨‹åº¦ä¸ `Integer.MAX_VALUE` å‘ˆä¸åŒçš„å€æ•°å…³ç³»æ—¶ï¼Œä¼šäº§ç”Ÿé”™è¯¯ç»“æœï¼ˆå“ˆå¸Œå†²çªï¼‰ï¼Œæ­¤æ—¶è€ƒè™‘ä¿®æ”¹ `p` æˆ–è€…é‡‡ç”¨è¡¨ç¤ºèŒƒå›´æ›´å¤§çš„ `long` æ¥ä»£æ›¿ `int`ã€‚

2.  `P = 131313` è¿™ä¸ªæ•°å­—æ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿ

WA å‡ºæ¥çš„ï¼Œåˆšå¼€å§‹ä½¿ç”¨çš„ `P = 131`ï¼Œè¢«å¡åœ¨äº† 30/31 ä¸ªæ ·ä¾‹ã€‚

å­—ç¬¦ä¸²å“ˆå¸Œæœ¬èº«å­˜åœ¨å“ˆå¸Œå†²çªçš„å¯èƒ½ï¼Œä¸€èˆ¬ä¼šåœ¨å°è¯• 131 ä¹‹åå°è¯•ä½¿ç”¨ 13131ï¼Œç„¶åå†å°è¯•ä½¿ç”¨æ¯” 13131 æ›´å¤§çš„è´¨æ•°ã€‚

---

æœ¬è´¨ä¸Šå’Œç¬¬ä¸€ç§æ–¹æ³•ä¸€æ ·ï¼Œjava é‡Œé¢åªä¸è¿‡ä»¥å‰çš„å“ˆå¸Œå€¼æ˜¯å­—ç¬¦ä¸²ï¼Œç°åœ¨çš„å­—ç¬¦ä¸²æ˜¯æ•´æ•°ï¼Œc++ä¸å­˜åœ¨

CPPçš„unordered_mapå°±ä¸éœ€è¦å†å°†å­—ç¬¦ä¸²è½¬hashå€¼äº†å˜»å˜»ğŸ­ğŸ­,åˆæ˜¯å·æ‡’çš„ä¸€å¤©

```cpp
class Solution {
public:
    vector<string> findRepeatedDnaSequences(string s) {
        vector<string> ans;
        int n=s.size();
        unordered_map<string,int> st;
        for(int i=0,j=9;j<n;j++,i++){
            if(st[s.substr(i,10)]==1){
                ans.push_back(s.substr(i,10));
            }
            st[s.substr(i,10)]++;
        }
        return ans;
    }
};
```

